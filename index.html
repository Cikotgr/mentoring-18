<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
</head>
<body>
    <H1>Produksi APPS</H1>
    <div class="container text-center">
        <div class="row pt-5">
            <div class="col">
                <button type="button" id="produk-btn" class="w-100 btn btn-primary">Pilih Produk</button>
            </div>
            <div class="col">
                <input class="form-control" name="kode-produk" type="text" placeholder="KODE" aria-label="default input example" disabled>
            </div>
            <div class="col">
                <input class="form-control" name="nama-produk" type="text" placeholder="NAMA" aria-label="default input example" disabled>
            </div>
            <div class="col">
                <input class="form-control" name="jumlah-produk" type="number" placeholder="JUMLAH" aria-label="default input example">
            </div>
        </div>
        <div class="row pt-3">
            <div class="col">
                <button type="button" id="bahan-btn" class="w-100 btn btn-primary">Pilih bahan</button>
            </div>
            <div class="col">
                <input class="form-control" type="text" name="kode-bahan" placeholder="KODE" aria-label="default input example">
            </div>
            <div class="col">
                <input class="form-control" type="text" name="nama-bahan" placeholder="NAMA" aria-label="default input example">
            </div>
            <div class="col">
                <button type="button" id="add-bahan" class="w-100 btn btn-primary">Tambah Bahan</button>
            </div>
        </div>
        <hr>

        <div class="container-bahan">
            <form id="form-bahan">
            <input class="form-control" name="kode-produk" type="text" placeholder="KODE" aria-label="default input example" hidden>
            <input class="form-control" name="nama-produk" type="text" placeholder="NAMA" aria-label="default input example" hidden>
            <input class="form-control" name="jumlah-produk-akhir" type="number" placeholder="JUMLAH" aria-label="default input example" hidden>
            
            <button class="btn btn-secondary" type="submit">Proses</button>
            </form>
        </div>

    </div>

    
    <div class="modal fade" id="produk" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable">
          <div class="modal-content">
            <div class="modal-header">
              <h1 class="modal-title fs-5" id="staticBackdropLabel">Modal title</h1>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table id="table-produk" class="table table-hover">
                <thead>
                    <tr>
                        <th>KODE</th>
                        <th>NAMA</th>
                    </tr>
                </thead>
                <tbody class="table-group-divider">
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
              <button type="button" class="btn btn-primary">Understood</button>
            </div>
          </div>
        </div>
    </div>

    <div class="modal fade" id="bahan" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable">
          <div class="modal-content">
            <div class="modal-header">
              <h1 class="modal-title fs-5" id="staticBackdropLabel">Modal title</h1>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table id="table-bahan" class="table table-hover">
                <thead>
                    <tr>
                        <th>KODE</th>
                        <th>NAMA</th>
                    </tr>
                </thead>
                <tbody class="table-group-divider">
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
              <button type="button" class="btn btn-primary">Understood</button>
            </div>
          </div>
        </div>
    </div>

    <div class="modal fade" id="result" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable">
          <div class="modal-content">
            <div class="modal-header">
              <h1 class="modal-title fs-5" id="staticBackdropLabel">Modal title</h1>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            
            <h5>Produk</h5>
            <table id="table-produk-result" class="table table-hover">
                <thead>
                    <tr>
                        <th>KODE</th>
                        <th>NAMA</th>
                        <th>JUMLAH</th>
                    </tr>
                </thead>
                <tbody class="table-group-divider">
                </tbody>
            <h5>Bahan</h5>
              </table>
              <table id="table-bahan-result" class="table table-hover">
                <thead>
                    <tr>
                        <th>KODE</th>
                        <th>NAMA</th>
                        <th>JUMLAH</th>
                    </tr>
                </thead>
                <tbody class="table-group-divider">
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
              <button type="button" class="btn btn-primary">Understood</button>
            </div>
          </div>
        </div>
    </div>

    <div class="modal fade" id="validation-produk" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h1 class="modal-title fs-5" id="exampleModalLabel">Modal title</h1>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              Pilih dan lengkapi data produk
            </div>
            </div>
          </div>
        </div>
      </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script> 
    <script src="https://code.jquery.com/jquery-3.7.1.slim.js" integrity="sha256-UgvvN8vBkgO0luPSUl2s8TIlOSYRoGFAX4jlCIm9Adc=" crossorigin="anonymous"></script>

    <script>
        $('#produk-btn').click(function (e) { 
            e.preventDefault();
            $('#produk').modal('show');
        });

        $('#bahan-btn').click(function (e) { 
            e.preventDefault();
            let nama_produk = $('input[name=nama-produk]').val();
            let jumlah_produk = $('input[name=jumlah-produk]').val();
            console.log(nama_produk);
            if(nama_produk == '' || jumlah_produk == ''){
                $('#validation-produk').modal('show');
            }else{
                $('#bahan').modal('show');
            }
        });

        let produk = [
    {
        "kode": "M123A",
        "nama": "Nasi Goreng"
    },
    {
        "kode": "P789B",
        "nama": "Ayam Bakar"
    },
    {
        "kode": "R456C",
        "nama": "Mie Ayam"
    },
    {
        "kode": "S987D",
        "nama": "Sate Ayam"
    },
    {
        "kode": "T654E",
        "nama": "Bakso"
    },
    {
        "kode": "U321F",
        "nama": "Soto Ayam"
    },
    {
        "kode": "V654G",
        "nama": "Nasi Padang"
    },
    {
        "kode": "W987H",
        "nama": "Gado-Gado"
    },
    {
        "kode": "X123I",
        "nama": "Rendang"
    },
    {
        "kode": "Y456J",
        "nama": "Mie Goreng"
    }
    ]

    let bahan = [
    {
        "kode": "A12B4",
        "nama": "Wortel"
    },
    {
        "kode": "C8D7E",
        "nama": "Kubis"
    },
    {
        "kode": "F3G9H",
        "nama": "Bayam"
    },
    {
        "kode": "I5J0K",
        "nama": "Tomat"
    },
    {
        "kode": "L6M1N",
        "nama": "Brokoli"
    },
    {
        "kode": "O7P2Q",
        "nama": "Terong"
    },
    {
        "kode": "R4S8T",
        "nama": "Selada"
    },
    {
        "kode": "U2V9W",
        "nama": "Bawang Merah"
    },
    {
        "kode": "X1Y6Z",
        "nama": "Lobak"
    },
    {
        "kode": "M3N7O",
        "nama": "Ketimun"
    }
    ]


        produk.forEach(element => {
            $('#table-produk tbody').append(`
                <tr>
                    <td>${element.kode}</td>
                    <td>${element.nama}</td>
                </tr>
            `);
        });

        bahan.forEach(element => {
            $('#table-bahan tbody').append(`
                <tr>
                    <td>${element.kode}</td>
                    <td>${element.nama}</td>
                </tr>
            `);
        });

        $('#table-produk tbody tr').click(function (e) { 
            e.preventDefault();
            let kode = $(this).find('td').eq(0).text();
            let nama = $(this).find('td').eq(1).text();
            $('input[name="kode-produk"]').val(kode);
            $('input[name="nama-produk"]').val(nama);
            $('#produk').modal('hide');
        });

        $('#table-bahan tbody tr').click(function (e) { 
            e.preventDefault();
            let kode = $(this).find('td').eq(0).text();
            let nama = $(this).find('td').eq(1).text();
            $('input[name="kode-bahan"]').val(kode);
            $('input[name="nama-bahan"]').val(nama);
            $('#bahan').modal('hide');
        });

        let sumBahan = 0;
        $('#add-bahan').click(function (e) { 
            e.preventDefault();
            let kode = $('input[name="kode-bahan"]').val();
            let nama = $('input[name="nama-bahan"]').val();
            $('.container-bahan form').append(`
                <div class="row pt-3" id="bahan-${sumBahan}">
                    <div class="col">
                        <input class="form-control" type="text" name="kode-bahan-${sumBahan}" placeholder="KODE" aria-label="default input example" value="${kode}" readonly>
                    </div>
                    <div class="col">
                        <input class="form-control" type="text" name="nama-bahan-${sumBahan}" placeholder="NAMA" aria-label="default input example" value="${nama}" readonly>
                    </div>
                    <div class="col">
                        <input required class="form-control" type="number" name="jumlah-bahan-${sumBahan}" placeholder="JUMLAH" aria-label="default input example">
                    </div>
                    <div class="col">
                        <button type="button" onClick=deleteBahan(${sumBahan}) id="delete-bahan" class="w-100 btn btn-danger">Hapus</button>
                    </div>
                </div>
            `);
            sumBahan++;
        });


        function deleteBahan($id){
            $('#bahan-'+$id).remove();
        }

        $('#form-bahan').submit(function (e) { 
            e.preventDefault();
            let jumlah =  $('input[name="jumlah-produk"]').val();
            $('input[name="jumlah-produk-akhir"]').val(jumlah);
            let form = $(this).serializeArray();
            
            console.log(form);

            $('#table-produk-result tbody').append(`
                <tr>
                    <td>${form[0].value}</td>
                    <td>${form[1].value}</td>
                    <td>${form[2].value}</td>
                </tr>
            `);

            for(let i = 3; i < form.length; i += 3){
                $('#table-bahan-result tbody').append(`
                    <tr>
                        <td>${form[i].value}</td>
                        <td>${form[i+1].value}</td>
                        <td>${form[i+2].value}</td>
                    </tr>
                `);
                
            }

            $('#result').modal('show');
        });


    </script>
</body>
</html>